# Лабораторная работа по методам идентификации и авторизации
## Todo
	1. Рефактор конфига
   		1.1. Описать в конфиге 3 типа аутентификации //Done
     		1.1.1. Аутентификация по паролю
			1.1.2. Аутентификация по токену
   			1.1.3. Двухфакторная аутентификация
      	1.2 Описать в конфиге политику паролей //Done
		1.3 Описать в добавить в базе пункт о блокировке юзера
	2. Рефактор класса Auth
		2.1. Описать метод сравнения
  		2.2. Описать метод Auth::Makeauth()
    	2.3. Описать Auth::InitConfig()
      	2.4. Описать метод блокировки юзера
			2.4.1. Разработать алгоритм блокировки юзера
   		2.5. Описать вторичную проверку
     		2.5.1. Разработать алгоритм для вторичной проверки
			2.5.2. Разработать метод включения вторичной проверки
	   		2.5.3. Свзять метод вторичной проверки с различными модулями пррограммы
      	2.6. Объединить Auth и Crypt
			2.6.1 Разработать механизм работы Crypt с постоянными обращениями к файлу
	3. Рефактор XMLParser
 		3.1. Переписать метод передачи юзеров в GUI
   		3.2. Описать парсер конфига для первого запуска
     	3.3. Обновить механизм работы с юзерами
	       	3.3.1. Добавить Юзеру статус (нормальная работа, блокировка, временная блокировка)
	4. Закодить генератор
	5. Закодить чекер
	6S. Закодить обработчик ошибок
 	7. Добавить GUI
  	8. Логи 
 	
	
## Идеи:
	
## Компоненты: 
### GUI
### Auth
	В процессе
	Отвечает за:
		Проверку 
### XMLParser
	Уже описан
	Отвечает за работу с конфиг файлом и базой юзеров
### Checker
	Отвечает за проверку паролей на соответствие правилам
 		Принимает интовое правило
   		Разбивает интовое правио на набор стандартных правил для проверки
     	Производит проверку пароля на соответствие правилам с помощью регулярных выражений
### Generator
	Отвечает за генерацию паролей по заданным требованиям
 		Принимает интовое правило
   		Разбивает интовое правило на набор стандартных правил для генерации
     		Генерирует пароль в соответствии с заданными правилами
### Crypto
	Отвечает за шифрование файла и хеширование данных
 		Принимает файл для шифрования
   		Производит шифрование или расшифрованиие файла по заданному ключу



## Структура:
	1. Запуск программы
		1.1 Auth пробует взять данные о USB накопителе
			1.1.1 Auth смог взять данные о USB накопителе
			1.1.2 Auth не смог взять данные о USB накопителе и выкидывает ошибку
		1.2 Auth на основе полученных данных создает данные для расшифровки конфига
		1.3 Auth пытается расшифровать конфиг
			1.3.1 Auth смог расшифровать конфиг
			1.3.2 Auth не смог расшифровать конфиг. Выкидывает ошибку
		1.4 Auth фиксирует хеш-сумму конфига и сохраняет ее у себя
		1.5 Auth с помощью ParseConfig вызывает XMLParser и пытается забрать данные с конфига метод аутентификации юзера, количество попыток для входа, таймер для блокировки и политику паролей.
		1.6 Auth шифрует файл назад
		1.7 Auth вызывает окно первичной авторизации
	2. Авторизация
		2.1 Auth забирает данные с формы авторизации
		2.2 Auth расшифровывает конфиг
		2.3 Auth сверяет хеш-суммы конфига
			2.3.1 Хеш суммы конфигов совпали
			2.3.2 Хеш суммы конфигов разнятся. Ошибка и остановка
		2.4 Auth пытается найти в базе совпадение по юзернейму
			2.4.1 XMLParser находит совпадение по логину и возвращает тройку логин:пароль:группа
			2.4.2 XMLParser не находит совпадений по логину и паролю и уменьшает количество оставшихся попыток для входа
		2.5 Auth запоминает фиксирует хеш-сумму файла
		2.6 Auth шифрует файл
		2.7 Сверяет введенный пароль с паролем из базы
			2.7.1 Пароль подходит
			2.7.2 Пароль не подходит, уменьшение количества попыток для входа
		2.8 Auth сверяет пользовательскую группу
			2.8.1 Группа User - запуск сценария User
			2.8.2 Группа Admin - запуск сценария Administrator
	3. Сценарий User
		3.1 Приветственный MessageBox
		3.2 Проверка введенного пароля на соответствие парольной политике с помощью Checker
			3.2.1 Checker возвращает положительный результат
			3.2.2 Checker возврашает отрицательный результат. Требуется смена пароля
		3.3 Работа программы завершается
	4. Сценарий Administrator
		4.1 Приветственный MessageBox
		4.2 Auth производит повторную проверку
			4.2.1 Auth сверяет сохраненную пару логин:пароль с введенной парой
				4.2.1.1 Пары логин:пароль совпадают
				4.2.1.2 Пары логин:пароль не совпадают
			4.2.2 Auth берет данные с файла
				4.2.2.1 Auth берет данные о накопителе
				4.2.2.2 Auth создает ключ расшифровки
				4.2.2.3 Auth сверяет ключи
				4.2.2.4 Auth расшифровывет файл
				4.2.2.5 Auth сверяет хеш-сумму
				4.2.2.6 Auth фиксирует хеш-сумму
				4.2.2.7 Auth шифрует файл
			4.2.3 Auth сверяет данные из базы с сохраненными данными
				4.2.3.1 Пара логин:пароль из базы совпали
				4.2.3.2 Пара логин:пароль из базы не совпадают с сохраненными
			4.2.4 Auth закрывает базу
		4.3 Auth ставит таймер до следующей проверки
		4.4 Проверка пароля на соответсвие парольной политике
			4.4.1 Пароль соответствует политике
			4.4.2 Пароль не соответствует политике. Требуется смена пароля
		4.5 Auth открывает окно администрирвания
		4.6 Auth запускает таймер бездействия
		4.7 На каждое действие в окне управления юзерами Auth вызывает повторную проверку данных и обновление таймера проверки
	5. Проверка пароля
		5.1 Checker принимает на вход пароль и интовый код правил для проверки
		5.2 Checker из кода правила с помощью Chechker::ParseRules() выделяет список критериев к паролю
		5.3 Checker с помощью Checher::Makecheck запускает проверку пароля на соответсвтие правилам
			5.3.1 Пароль соответсвует правилам
			5.3.2 Пароль не соответствует правилам. Выброс MessageBox
	6. Генерация пароля
		6.1 Generator на вход получает интоавый код правил для создания пароля
		6.2 Generator с помощью Generator::ParseRules выделяет список критериев к паролю
		6.3 Generator с помощью Generator::GenerateAlphabet генерирует алфавит
		6.4 Generator генерирует пароль
		6.5 Generator отправляет пароль на проверку в Checker
	
		

